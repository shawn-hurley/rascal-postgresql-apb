FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDc1ZTNjMGE3LWY3YjEtNDdkNy1iMTM3LTMyODNmNmZjNzM2ZApuYW1lOiBiaW5kLXBxLWFw\
YgppbWFnZTogc2h1cmxleS9yaHNjbC1wb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NMIFBv\
c3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25h\
bAptZXRhZGF0YTogCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5v\
cmcvZG9jcy8KICBsb25nRGVzY3JpcHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNx\
bCA5LjQgb3IgOS41LgogIGRlcGVuZGVuY2llczogWydyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNv\
bS9yaHNjbC9wb3N0Z3Jlc3FsLTk1LXJoZWw3J10KICBkaXNwbGF5TmFtZTogQmluZCBQb3N0Z3Jl\
U1FMIChBUEIpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXBvc3RncmVz\
cWwKICAKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUg\
ZXRoZXJwYWQgYXBwbGljYXRpb24gd2l0aCBubyBEQgogICAgZnJlZTogdHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhp\
cyBwbGFuIHByb3ZpZGVzIGEgc2luZ2xlIEV0aGVycGFkIGFwcGxpY2F0aW9uIHdpdGggbm8gZGF0\
YWJhc2VcCiAgICAgIGNvc3Q6ICQwLjAwCgogICAgcGFyYW1ldGVyczogCiAgICAgIC0gcG9zdGdy\
ZXNxbF9kYXRhYmFzZToKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUKICAgICAgICByZXF1aXJl\
ZDogdHJ1ZQogICAgICAKICAgICAgLSBwb3N0Z3Jlc3FsX3Bhc3N3b3JkOgogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIGRlc2NyaXB0aW9uOiBBIHJhbmRvbSBhbHBoYW51bWVyaWMgc3RyaW5n\
IGlmIGxlZnQgYmxhbmsKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29yZAogICAgICAg\
ICAgCiAgICAgIC0gcG9zdGdyZXNxbF9zaW5nbGVfdXNlcjoKICAgICAgICB0eXBlOiBlbnVtCiAg\
ICAgICAgZGVzY3JpcHRpb246IFNob3VsZCB0aGUgZGF0YWJhc2UgY3JlYXRlIG5ldyB1c2VyIG9u\
IGVhY2ggYmluZGluZyBvciByZS11c2UgYSBzaW5nbGUgdXNlci4KICAgICAgICB0aXRsZTogU2lu\
Z2xlIFVzZXIgb3IgTXVsdGlwbGUgVXNlcnMKICAgICAgICBlbnVtOiBbJ3NpbmdsZScsICdtdWx0\
aXBsZSddCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICAgICAgICAKICAgICAgLSBwb3N0\
Z3Jlc3FsX3ZlcnNpb246CiAgICAgICAgZGVmYXVsdDogOS41CiAgICAgICAgZW51bTogWyc5LjUn\
LCAnOS40J10KICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\
ICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICAgIApkZXBlbmRlbmNpZXM6IAogIC0gcG9z\
dGdyZXNxbF92ZXJzaW9uCiAgLSByZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNvbS9yaHNjbC97ewog\
IAo="

RUN yum -y install postgresql-libs python-psycopg2 && yum clean all
COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/

USER apb
