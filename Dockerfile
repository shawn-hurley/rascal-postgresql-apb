FROM ansibleplaybookbundle/apb-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"aWQ6IDc1ZTNjMGE3LWY3YjEtNDdkNy1iMTM3LTMyODNmNmZjNzM2ZApuYW1lOiBiaW5kLXBxLWFw\
YgppbWFnZTogc2h1cmxleS9yaHNjbC1wb3N0Z3Jlc3FsLWFwYgpkZXNjcmlwdGlvbjogU0NMIFBv\
c3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25h\
bAptZXRhZGF0YTogCiAgZG9jdW1lbnRhdGlvblVybDogaHR0cHM6Ly93d3cucG9zdGdyZXNxbC5v\
cmcvZG9jcy8KICBsb25nRGVzY3JpcHRpb246IEFuIGFwYiB0aGF0IGRlcGxveXMgcG9zdGdyZXNx\
bCA5LjQgb3IgOS41LgogIGRlcGVuZGVuY2llczogWydyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNv\
bS9yaHNjbC9wb3N0Z3Jlc3FsLTk1LXJoZWw3J10KICBkaXNwbGF5TmFtZTogQmluZCBQb3N0Z3Jl\
U1FMIChBUEIpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXBvc3RncmVz\
cWwKICAKcGFyYW1ldGVyczogCiAgLSBwb3N0Z3Jlc3FsX2RhdGFiYXNlOgogICAgICBkZWZhdWx0\
OiBhZG1pbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IFBvc3RncmVTUUwgRGF0YWJh\
c2UgTmFtZQogICAgICAKICAtIHBvc3RncmVzcWxfcGFzc3dvcmQ6CiAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0cmluZyBpZiBsZWZ0\
IGJsYW5rCiAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBhc3N3b3JkCiAgICAgIAogIC0gcG9zdGdy\
ZXNxbF92ZXJzaW9uOgogICAgICBkZWZhdWx0OiA5LjUKICAgICAgZW51bTogWyc5LjUnLCAnOS40\
J10KICAgICAgdHlwZTogZW51bQogICAgICB0aXRsZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICAg\
IAogIApyZXF1aXJlZDogCiAgLSBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgLSBwb3N0Z3Jlc3FsX3Zl\
cnNpb24KICAKZGVwZW5kZW5jaWVzOiAKICAtIHBvc3RncmVzcWxfdmVyc2lvbgogIC0gcmVnaXN0\
cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wve3sKICAK"

RUN yum -y install postgresql-libs python-psycopg2 && yum clean all
COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/

USER apb
